openapi: 3.0.0
info:
  title: Minswap Aggregator API Documentation
  version: 1.0.0
  description: >
    The Minswap Aggregator API provides direct access to Minswap's aggregation functionality
    for partners who want to implement their own interface and control the trading logic.
servers:
  - url: https://dev-3.minswap.org/aggregator
    description: Production server

components:
  schemas:
    Protocol:
      type: string
      enum:
        - MinswapV2
        - Minswap
        - MinswapStable
        - MuesliSwap
        - Splash
        - SundaeSwapV3
        - SundaeSwap
        - VyFinance
        - WingRidersV2
        - WingRiders
        - WingRidersStableV2
        - Spectrum
        - SplashStable
    Asset:
      type: object
      required:
        - token_id
      properties:
        token_id:
          type: string
          description: |
            Token identifier, two possible formats:
            - For ADA: use "lovelace"
            - For other tokens: concatenate <policyId><tokenName> in hex
            Example: "29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c64d494e" for MIN token
        logo:
          type: string
          nullable: true
          description: |
            Logo url of the token
            Can be null if no logo is available
        ticker:
          type: string
          nullable: true
          description: |
            Token ticker symbol (if available)
            Can be null for tokens without a ticker symbol
            Example: "MIN", "iUSD", "DJED"
          example: "MIN"
        is_verified:
          type: boolean
          nullable: true
          description: |
            Token verification status on Minswap
            - true: Token is verified by Minswap
            - false: Token is not verified
            - null: Verification status unknown
          example: true
        price_by_ada:
          type: number
          nullable: true
          description: |
            Token price denominated in ADA
            Can be null if price information is unavailable
            Example: 1.5 means 1 token = 1.5 ADA
          example: 1.5
        project_name:
          type: string
          nullable: true
          description: |
            Name of the project that issued the token
            Can be null for unknown projects
            Example: "Minswap", "Indigo"
          example: "Minswap"
        decimals:
          type: number
          nullable: true
          description: |
            Number of decimal places for the token
            - ADA always has 6 decimals (1 ADA = 1,000,000 lovelace)
            - Most tokens follow the 6 decimal standard
            - Can be null for tokens with unknown decimals
            Example: 6 means divide by 1,000,000 to get actual amount
          example: 6
paths:
  /ada-price:
    get:
      summary: Get current ADA price in multiple currencies
      parameters:
        - name: currency
          in: query
          required: true
          schema:
            type: string
            enum:
              - aed  # UAE Dirham
              - ars  # Argentine Peso
              - aud  # Australian Dollar
              - bdt  # Bangladeshi Taka
              - bhd  # Bahraini Dinar
              - bmd  # Bermudian Dollar
              - brl  # Brazilian Real
              - cad  # Canadian Dollar
              - chf  # Swiss Franc
              - clp  # Chilean Peso
              - cny  # Chinese Yuan
              - czk  # Czech Koruna
              - dkk  # Danish Krone
              - eur  # Euro
              - gbp  # British Pound
              - hkd  # Hong Kong Dollar
              - huf  # Hungarian Forint
              - idr  # Indonesian Rupiah
              - ils  # Israeli New Shekel
              - inr  # Indian Rupee
              - jpy  # Japanese Yen
              - krw  # South Korean Won
              - kwd  # Kuwaiti Dinar
              - lkr  # Sri Lankan Rupee
              - mmk  # Myanmar Kyat
              - mxn  # Mexican Peso
              - myr  # Malaysian Ringgit
              - ngn  # Nigerian Naira
              - nok  # Norwegian Krone
              - nzd  # New Zealand Dollar
              - php  # Philippine Peso
              - pkr  # Pakistani Rupee
              - pln  # Polish Złoty
              - rub  # Russian Ruble
              - sar  # Saudi Riyal
              - sek  # Swedish Krona
              - sgd  # Singapore Dollar
              - thb  # Thai Baht
              - try  # Turkish Lira
              - twd  # New Taiwan Dollar
              - uah  # Ukrainian Hryvnia
              - usd  # US Dollar
              - vef  # Venezuelan Bolívar
              - vnd  # Vietnamese Đồng
              - xdr  # Special Drawing Rights
              - zar  # South African Rand
          example: "usd"
          description: |
            Currency code to get ADA price in.
            Common values: usd, eur, jpy.
      responses:
        '200':
          description: Current ADA price and 24-hour change in requested currency
          content:
            application/json:
              schema:
                type: object
                properties:
                  currency:
                    type: string
                    description: |
                      The requested currency code in lowercase
                      Example: "usd", "eur", "gbp"
                    example: "usd"
                  value:
                    type: object
                    nullable: true
                    description: |
                      Price information (null if price data unavailable)
                    properties:
                      change_24h:
                        type: number
                        description: |
                          24-hour price change percentage
                          - Positive value: price increased
                          - Negative value: price decreased
                          Example: -2.34 means price dropped 2.34%
                        example: -2.34
                      price:
                        type: number
                        description: |
                          Current price in the requested currency
                          Example: 0.75 means 1 ADA = $0.75 USD
                        example: 0.75
  /wallet:
    get:
      summary: Query wallet balances and token information
      parameters:
        - name: address
          in: query
          required: true
          schema:
            type: string
          example: "addr1..."
          description: |
            Cardano wallet address to query
            - Supports both Cbor and Hex format addresses
            - Will be normalized to Cbor format in response
      responses:
        '200':
          description: Detailed wallet balance information including ADA and native tokens
          content:
            application/json:
              schema:
                type: object
                properties:
                  wallet:
                    type: string
                    description: |
                      The wallet address in cbor format
                      Example: "addr1..."
                    example: "addr1..."
                  ada:
                    type: string
                    description: |
                      ADA balance in lovelace (smallest unit).
                      - 1 ADA = 1,000,000 lovelace
                      - Returned as string to handle large numbers accurately
                      - Example: "5000000" represents 5 ADA
                    example: "5000000"
                  minimum_lovelace:
                    type: string
                    description: |
                      Minimum required ADA for the wallet in lovelace.
                      This represents the minimum ADA required to hold native tokens due to the Cardano protocol's UTxO rules.
                      Example: "1000000" means 1 ADA minimum required.
                    example: "1000000"
                  balance:
                    type: array
                    description: |
                      Array of token balances held in the wallet.
                      Each entry represents a different token's balance and metadata.
                      ADA (lovelace) is not included here as it has its own field 'ada'.
                    items:
                      type: object
                      description: Token balance entry with asset information
                      properties:
                        asset:
                          $ref: '#/components/schemas/Asset'
                          description: Detailed information about the token
                        amount:
                          type: string
                          description: |
                            Token balance in smallest unit (considering decimals)
                            Examples:
                            - "1000000" with decimals=6 means 1.0 tokens
                            - "1000000000" with decimals=6 means 1,000.0 tokens
                            Note: Always returned as string to handle large numbers accurately
  /tokens:
    post:
      summary: Search and filter token information with pagination
      description: |
        Search for tokens with optional filtering and pagination support. Results can be filtered
        to only show verified tokens, specific token IDs, or tokens matching a search query.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - query
                - only_verified
              properties:
                query:
                  type: string
                  description: |
                    Search query string to match against:
                    - Token name (e.g., "Minswap")
                    - Token ticker (e.g., "MIN")
                    - Policy ID
                    Empty string returns all tokens (subject to other filters)
                  example: "min"
                only_verified:
                  type: boolean
                  description: |
                    When true, returns only tokens verified by Minswap
                    - true: Only verified tokens
                    - false: All tokens including unverified ones
                  example: true
                assets:
                  type: array
                  items:
                    type: string
                  description: |
                    Optional list of specific token_ids to fetch
                    Format: Array of "<policyId><tokenName>" strings
                    Example: ["29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c64d494e"]
                  example: ["29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c64d494e"]
                search_after:
                  type: array
                  items:
                    type: string
                  description: |
                    Pagination cursor from previous response
      responses:
        '200':
          description: Token search results with pagination information
          content:
            application/json:
              schema:
                type: object
                properties:
                  tokens:
                    type: array
                    description: |
                      Array of tokens matching the search criteria.
                      May be empty if no tokens match or all are filtered out.
                    items:
                      $ref: '#/components/schemas/Asset'
                  search_after:
                    type: array
                    items:
                      type: string
                    description: |
                      Pagination cursor for the next page
  /estimate:
    post:
      summary: Get optimal swap route and price estimation across DEX protocols
      description: |
        Find the best possible swap route and price estimation by aggregating liquidity
        across multiple DEX protocols. Supports direct swaps and multi-hop routing.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - amount
                - token_in
                - token_out
                - slippage
              properties:
                amount:
                  type: string
                  description: |
                    Amount of input token in its smallest unit:
                    - For ADA: amount in lovelace (1 ADA = 1,000,000 lovelace)
                    - For other tokens: amount * (10 ^ decimals)
                    Examples:
                    - "1000000" means 1 ADA when token_in is "lovelace"
                    - "1000000" means 1 MIN when token_in is MIN (6 decimals)
                  example: "10000000"
                token_in:
                  type: string
                  description: |
                    Input token identifier:
                    - For ADA: use "lovelace"
                    - For other tokens: use "<policyId><tokenName>" format
                    Example: "29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c64d494e" for MIN token
                  example: "lovelace"
                token_out:
                  type: string
                  description: |
                    Output token identifier:
                    - For ADA: use "lovelace"
                    - For other tokens: use "<policyId><tokenName>" format
                    Must be different from token_in
                  example: "29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c64d494e"
                slippage:
                  type: number
                  description: |
                    Maximum acceptable slippage percentage:
                    - Examples: 0.5 means 0.5% slippage tolerance
                    - Used to calculate min_amount_out
                  example: 0.5
                exclude_protocols:
                  type: array
                  items:
                    $ref: '#/components/schemas/Protocol'
                  description: |
                    Optional list of DEX protocols to exclude from routing:
                    - Useful for avoiding specific DEXs
                    - Minswap protocols cannot be excluded
                allow_multi_hops:
                  type: boolean
                  description: |
                    Control whether multi-hop swaps are allowed:
                    - true: Allow routing through multiple pools to find best price
                    - false: Only allow direct swaps through a single pool
                    
                    Multi-hop swaps can often provide better prices by routing through 
                    intermediate tokens, but may have higher total fees due to multiple swaps.
                    Example: ADA -> MIN -> iUSD might be more efficient than direct ADA -> iUSD
                partner:
                  type: string
                  description: |
                    Partner identifier for tracking and analytics:
                    - Optional string to identify the partner integration
                    - Used for volume tracking and potential fee sharing programs
      responses:
        '200':
          description: |
            Successful route estimation response containing detailed information about:
            - Token amounts and minimums
            - Fee breakdowns (LP, DEX, and aggregator fees)
            - Price impact
            - Detailed routing paths through different DEX protocols
          content:
            application/json:
              schema:
                type: object
                properties:
                  token_in:
                    type: string
                    description: |
                      Input token identifier (matches request)
                      Example: "lovelace" for ADA
                  token_out:
                    type: string
                    description: |
                      Output token identifier (matches request)
                      Example: "29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c64d494e" for MIN
                  amount_in:
                    type: string
                    description: |
                      Total input amount in smallest units (matches request)
                      Examples:
                      - "1000000" means 1 ADA when token_in is "lovelace"
                      - "1000000" means 1 MIN when token_in is MIN (6 decimals)
                  amount_out:
                    type: string
                    description: |
                      Expected output amount in smallest units
                      This is the estimated amount before slippage
                      Example: "950000" means 0.95 tokens with 6 decimals
                  min_amount_out:
                    type: string
                    description: |
                      Minimum output amount considering slippage
                  total_lp_fee:
                    type: string
                    description: |
                      Total LP fees across all pools in the route
                      Sum of all lp_fee values from individual paths
                      Example: "1000" means 0.001 tokens with 6 decimals
                  total_dex_fee:
                    type: string
                    description: |
                      Total DEX protocol fees across all pools in lovelace
                  deposits:
                    type: string
                    description: |
                      Total required ADA deposits for output tokens
                      Required by Cardano protocol for holding native tokens
                      Example: "1500000" means 1.5 ADA deposit required
                  avg_price_impact:
                    type: number
                    description: |
                      Average price impact percentage across all pools
                      Lower is better, high values indicate significant market impact
                      Example: 0.5 means 0.5% price impact
                  paths:
                    type: array
                    description: |
                      Detailed routing information through DEX pools
                      For multi-hop routes, contains multiple hops
                      For direct swaps, contains a single hop
                    items:
                      type: array
                      description: |
                        Array of hops in the route
                        Each array represents one complete path from input to output token
                      items:
                        type: object
                        description: |
                          Individual swap/hop information through a specific pool
                        properties:
                          pool_id:
                            type: string
                            description: |
                              Unique identifier for the liquidity pool
                              Format varies by protocol
                          protocol:
                            $ref: '#/components/schemas/Protocol'
                            description: |
                              DEX protocol used for this hop
                              Each protocol may have different fee structures
                          lp_token:
                            type: string
                            description: |
                              Liquidity pool token identifier
                          token_in:
                            type: string
                            description: |
                              Input token for this specific hop
                              For multi-hop routes, may be different from overall token_in
                          token_out:
                            type: string
                            description: |
                              Output token for this specific hop
                              For multi-hop routes, may be different from overall token_out
                          amount_in:
                            type: string
                            description: |
                              Input amount for this hop in smallest units
                              For multi-hop routes, output of previous hop
                          amount_out:
                            type: string
                            description: |
                              Expected output amount for this hop
                              For final hop, contributes to overall amount_out
                          min_amount_out:
                            type: string
                            description: |
                              Minimum output amount for this hop with slippage
                              Ensures each hop meets minimum requirements
                          lp_fee:
                            type: string
                            description: |
                              LP fee amount for this hop in smallest units
                              Paid to liquidity providers
                          dex_fee:
                            type: string
                            description: |
                              Protocol fee amount for this hop in lovelace
                              Paid to the DEX protocol
                          deposits:
                            type: string
                            description: |
                              Required ADA deposit for this hop
                          price_impact:
                            type: number
                            description: |
                              Price impact percentage for this specific hop
                              Lower values indicate better pricing
                  aggregator_fee:
                    type: string
                    description: |
                      Aggregator service fee amount in lovelace
                  aggregator_fee_percent:
                    type: number
                    description: |
                      Aggregator fee percentage
                      Example: 0.5
  /build-tx:
    post:
      summary: Build unsigned swap transaction
      description: |
        Constructs an unsigned Cardano transaction for performing the swap operation.
        This endpoint uses the results from /estimate to build a valid transaction
        that can be signed by the user's wallet and submitted to the network.
        
        The transaction will:
        1. Take tokens from the sender's wallet
        2. Execute swaps through specified DEX protocols
        3. Return output tokens to the sender
        4. Handle all necessary ADA deposits and fee payments
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sender:
                  type: string
                  description: |
                    Cardano wallet address that will:
                    - Provide the input tokens
                    - Pay transaction fees
                    - Receive output tokens
                min_amount_out:
                  type: string
                  description: |
                    Minimum acceptable output amount in smallest units
                    Must be greater than or equal to the min_amount_out
                    from the /estimate response to ensure price protection
                    
                    Example: "950000" for 0.95 tokens with 6 decimals
                estimate:
                  type: object
                  description: |
                    Swap parameters matching a previous /estimate call
                    The transaction will be built according to these parameters
                    Must match the exact values used in /estimate to ensure
                    the route and pricing remain valid
                  properties:
                    amount:
                      type: string
                      description: |
                        Amount of input tokens in smallest units
                        Must match the amount used in /estimate
                        Example: "1000000" for 1 token with 6 decimals
                    token_in:
                      type: string
                      description: |
                        Input token identifier
                        Must match the token_in used in /estimate
                        Example: "lovelace" for ADA
                    token_out:
                      type: string
                      description: |
                        Output token identifier
                        Must match the token_out used in /estimate
                        Example: "<policy_id><asset_name>" for native tokens
                    slippage:
                      type: number
                      description: |
                        Maximum acceptable slippage percentage
                        Must match the slippage used in /estimate
                        Example: 0.5 for 0.5% slippage tolerance
                    exclude_protocols:
                      type: array
                      items:
                        $ref: '#/components/schemas/Protocol'
                      description: |
                        Optional list of DEX protocols to exclude
                        Must match exclude_protocols used in /estimate
                    allow_multi_hops:
                      type: boolean
                      description: |
                        Whether to allow multi-hop routes
                        Must match allow_multi_hops used in /estimate
                    partner:
                      type: string
                      description: |
                        Partner identifier for fee tracking
                        Must match partner used in /estimate if provided
              required:
                - sender
                - min_amount_out
                - estimate
      responses:
        '200':
          description: |
            Successfully built unsigned transaction
            The returned CBOR can be signed by the sender's wallet
          content:
            application/json:
              schema:
                type: object
                properties:
                  cbor:
                    type: string
                    description: |
                      Unsigned transaction in CBOR format
                      This can be:
                      1. Signed using the sender's wallet
                      2. Submitted to /finalize-and-submit-tx with witness data
                      
                      Example: "84a400..." (hex-encoded CBOR)
  /finalize-and-submit-tx:
    post:
      summary: Submit signed transaction to network
      description: |
        Submits a signed transaction to the Cardano network. This endpoint should be called
        after getting the unsigned transaction from /build-tx and signing it with the sender's wallet.
        
        The endpoint will:
        1. Validate the transaction and witness data
        2. Submit the transaction to the Cardano network
        3. Return the transaction ID for tracking
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                cbor:
                  type: string
                  description: |
                    Unsigned transaction CBOR from /build-tx response
                    Must be the exact CBOR string received, unmodified
                    Example: "84a400..." (hex-encoded CBOR)
                witness_set:
                  type: string
                  description: |
                    Witness data containing the transaction signature
                    Generated by the sender's wallet when signing
                    Must be hex-encoded
                    Example: "a100..." (hex-encoded witness data)
              required:
                - cbor
                - witness_set
      responses:
        '200':
          description: |
            Transaction successfully submitted to the network
            The transaction will be processed in the next available block
          content:
            application/json:
              schema:
                type: object
                properties:
                  tx_id:
                    type: string
                    description: |
                      Transaction ID (hash) for tracking
                      Can be used to:
                      - Monitor transaction status
                      - Look up transaction on block explorers
                      Example: "1abc..." (hex-encoded transaction hash)
  /cancel-tx:
    post:
      summary: Build transaction to cancel pending orders
      description: |
        Builds an unsigned transaction that cancels pending swap orders.
        This is useful when:
        - A swap transaction is stuck or pending
        - You want to reclaim tokens from an unfilled order
        - You want to cancel multiple orders at once
        
        Supports cancelling orders across multiple DEX protocols
        Can cancel up to 6 orders in a single transaction
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sender:
                  type: string
                  description: |
                    Cardano wallet address that:
                    - Originally created the orders
                    - Will pay transaction fees
                    - Will receive refunded tokens
                    
                    Must be in bech32 format
                    Example: "addr1..."
                orders:
                  type: array
                  description: |
                    List of orders to cancel
                    Each order must belong to the sender
                    Orders are processed in the given order
                  minItems: 1
                  maxItems: 6
                  items:
                    type: object
                    description: Individual order cancellation details
                    properties:
                      tx_in:
                        type: string
                        description: |
                          Transaction input pointer (TxHash#Index) for the order
                          Format: "<transaction_hash>#<output_index>"
                          Example: "1abc...#0"
                      protocol:
                        $ref: '#/components/schemas/Protocol'
                        description: |
                          DEX protocol where the order was placed
                          Must match the protocol used to create the order
                    required:
                      - tx_in
                      - protocol
              required:
                - sender
                - orders
      responses:
        '200':
          description: |
            Successfully built unsigned cancellation transaction
            The returned CBOR can be signed by the sender's wallet
          content:
            application/json:
              schema:
                type: object
                properties:
                  cbor:
                    type: string
                    description: |
                      Unsigned transaction in CBOR format
                      This can be:
                      1. Signed using the sender's wallet
                      2. Submitted to /finalize-and-submit-tx with witness data
                      
                      Example: "84a400..." (hex-encoded CBOR)
